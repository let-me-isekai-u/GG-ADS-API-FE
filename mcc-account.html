<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Google Ads API - Nhập MCC và tạo Sub-account</title>
  <link href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css" rel="stylesheet" />
  <style>
    form {
      display: block;
      max-width: 500px;
      margin: 0 auto;
    }
    form label {
      display: block;
      margin-bottom: 10px;
    }
    form input, form select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .button-container {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }
    button {
      width: 48%;
      padding: 10px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
    .button-container button:nth-child(2) {
      background-color: #f44336;
    }
    .button-container button:nth-child(2):hover {
      background-color: #e53935;
    }
    .message {
      text-align: center;
      margin-top: 20px;
      padding: 10px;
      border-radius: 4px;
      font-weight: bold;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: #fff;
      padding: 20px;
      border-radius: 6px;
      text-align: center;
      width: 90%;
      max-width: 400px;
    }
    .modal-content h3 {
      margin-bottom: 20px;
    }
    .modal-buttons {
      display: flex;
      justify-content: space-between;
    }
    .modal-buttons button {
      width: 48%;
    }
    .view-list-button {
      display: block;
      margin: 20px auto;
      padding: 10px;
      width: 200px;
      background-color: #2196F3;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      text-align: center;
    }
    .view-list-button:hover {
      background-color: #1976D2;
    }
  </style>
</head>
<body>
  <h2 style="text-align: center;">Nhập MCC và tạo Sub-account</h2>
  <form id="mccForm">
  <!---Các trường-->
    <label for="managerAccountId">Mã tài khoản quản lý (MCC):
      <input type="text" id="managerAccountId" name="managerAccountId" value="A" required>
    </label>
    
    <label for="accountName">Tên tài khoản:
      <input type="text" id="accountName" name="accountName" value="" required>
    </label>
    
    <label for="currencyCode">Tiền tệ (VD: VND, USD):
      <select id="currencyCode" name="currencyCode" required></select>
    </label>
    
    <label for="timeZone">Múi giờ (VD: +7 (Asia/Ho_Chi_Minh)):
      <select id="timeZone" name="timeZone" required></select>
    </label>
    
    <label for="numberOfAccount">Số lượng tài khoản con:
      <input type="number" id="numberOfAccount" name="numberOfAccount" value="" min="1" required>
    </label>

    <div class="button-container">
      <button type="button" id="saveButton">Lưu</button>
      <button type="submit">Chạy</button>
    </div>
  </form>

  <button class="view-list-button" onclick="window.location.href='list-accounts.html'">Xem danh sách</button>

  <div id="result" class="message"></div>

  <!-- Modal chạy thành công -->
  <div class="modal" id="successModal">
    <div class="modal-content">
      <h3>Chạy thành công!</h3>
      <div class="modal-buttons">
        <button id="confirmBtn">Xác nhận</button>
        <button onclick="window.location.href='list-accounts.html'">Xem danh sách</button>
      </div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.min.js"></script>
  <script>
    window.onload = async function () {
      const timeZoneSelect = document.getElementById('timeZone');
      const currencySelect = document.getElementById('currencyCode');

      // Load múi giờ
      const timeZones = [
  "(unknown) Africa/Abidjan",
  "(unknown) Africa/Accra",
  "(unknown) Africa/Bamako",
  "(unknown) Africa/Banjul",
  "(unknown) Africa/Bissau",
  "(unknown) Africa/Conakry",
  "(unknown) Africa/Dakar",
  "(unknown) Africa/Freetown",
  "(unknown) Africa/Lome",
  "(unknown) Africa/Monrovia",
  "(unknown) Africa/Nouakchott",
  "(unknown) Africa/Ouagadougou",
  "(unknown) Africa/Sao_Tome",
  "(unknown) America/Danmarkshavn",
  "(unknown) Atlantic/Azores",
  "(unknown) Atlantic/Reykjavik",
  "(unknown) Atlantic/St_Helena",
  "+1 (Africa/Algiers)",
  "+1 (Africa/Bangui)",
  "+1 (Africa/Brazzaville)",
  "+1 (Africa/Casablanca)",
  "+1 (Africa/Douala)",
  "+1 (Africa/El_Aaiun)",
  "+1 (Africa/Kinshasa)",
  "+1 (Africa/Lagos)",
  "+1 (Africa/Libreville)",
  "+1 (Africa/Luanda)",
  "+1 (Africa/Malabo)",
  "+1 (Africa/Ndjamena)",
  "+1 (Africa/Niamey)",
  "+1 (Africa/Porto-Novo)",
  "+1 (Africa/Tunis)",
  "+1 (Atlantic/Canary)",
  "+1 (Atlantic/Faeroe)",
  "+1 (Atlantic/Madeira)",
  "+1 (Europe/Dublin)",
  "+1 (Europe/Guernsey)",
  "+1 (Europe/Isle_of_Man)",
  "+1 (Europe/Jersey)",
  "+1 (Europe/Lisbon)",
  "+1 (Europe/London)",
  "+10 (Antarctica/DumontDUrville)",
  "+10 (Antarctica/Macquarie)",
  "+10 (Asia/Ust-Nera)",
  "+10 (Asia/Vladivostok)",
  "+10 (Australia/Brisbane)",
  "+10 (Australia/Hobart)",
  "+10 (Australia/Lindeman)",
  "+10 (Australia/Melbourne)",
  "+10 (Australia/Sydney)",
  "+10 (Pacific/Guam)",
  "+10 (Pacific/Port_Moresby)",
  "+10 (Pacific/Saipan)",
  "+10 (Pacific/Truk)",
  "+10:30 (Australia/Lord_Howe)",
  "+11 (Asia/Magadan)",
  "+11 (Asia/Sakhalin)",
  "+11 (Asia/Srednekolymsk)",
  "+11 (Pacific/Bougainville)",
  "+11 (Pacific/Efate)",
  "+11 (Pacific/Guadalcanal)",
  "+11 (Pacific/Kosrae)",
  "+11 (Pacific/Norfolk)",
  "+11 (Pacific/Noumea)",
  "+11 (Pacific/Ponape)",
  "+12 (Antarctica/McMurdo)",
  "+12 (Asia/Anadyr)",
  "+12 (Asia/Kamchatka)",
  "+12 (Pacific/Auckland)",
  "+12 (Pacific/Fiji)",
  "+12 (Pacific/Funafuti)",
  "+12 (Pacific/Kwajalein)",
  "+12 (Pacific/Majuro)",
  "+12 (Pacific/Nauru)",
  "+12 (Pacific/Tarawa)",
  "+12 (Pacific/Wake)",
  "+12 (Pacific/Wallis)",
  "+12:45 (Pacific/Chatham)",
  "+13 (Pacific/Apia)",
  "+13 (Pacific/Enderbury)",
  "+13 (Pacific/Fakaofo)",
  "+13 (Pacific/Tongatapu)",
  "+14 (Pacific/Kiritimati)",
  "+2 (Africa/Blantyre)",
  "+2 (Africa/Bujumbura)",
  "+2 (Africa/Ceuta)",
  "+2 (Africa/Gaborone)",
  "+2 (Africa/Harare)",
  "+2 (Africa/Johannesburg)",
  "+2 (Africa/Juba)",
  "+2 (Africa/Khartoum)",
  "+2 (Africa/Kigali)",
  "+2 (Africa/Lubumbashi)",
  "+2 (Africa/Lusaka)",
  "+2 (Africa/Maputo)",
  "+2 (Africa/Maseru)",
  "+2 (Africa/Mbabane)",
  "+2 (Africa/Tripoli)",
  "+2 (Africa/Windhoek)",
  "+2 (Antarctica/Troll)",
  "+2 (Arctic/Longyearbyen)",
  "+2 (Europe/Amsterdam)",
  "+2 (Europe/Andorra)",
  "+2 (Europe/Belgrade)",
  "+2 (Europe/Berlin)",
  "+2 (Europe/Bratislava)",
  "+2 (Europe/Brussels)",
  "+2 (Europe/Budapest)",
  "+2 (Europe/Busingen)",
  "+2 (Europe/Copenhagen)",
  "+2 (Europe/Gibraltar)",
  "+2 (Europe/Kaliningrad)",
  "+2 (Europe/Ljubljana)",
  "+2 (Europe/Luxembourg)",
  "+2 (Europe/Madrid)",
  "+2 (Europe/Malta)",
  "+2 (Europe/Monaco)",
  "+2 (Europe/Oslo)",
  "+2 (Europe/Paris)",
  "+2 (Europe/Podgorica)",
  "+2 (Europe/Prague)",
  "+2 (Europe/Rome)",
  "+2 (Europe/San_Marino)",
  "+2 (Europe/Sarajevo)",
  "+2 (Europe/Skopje)",
  "+2 (Europe/Stockholm)",
  "+2 (Europe/Tirane)",
  "+2 (Europe/Vaduz)",
  "+2 (Europe/Vatican)",
  "+2 (Europe/Vienna)",
  "+2 (Europe/Warsaw)",
  "+2 (Europe/Zagreb)",
  "+2 (Europe/Zurich)",
  "+3 (Africa/Addis_Ababa)",
  "+3 (Africa/Asmera)",
  "+3 (Africa/Cairo)",
  "+3 (Africa/Dar_es_Salaam)",
  "+3 (Africa/Djibouti)",
  "+3 (Africa/Kampala)",
  "+3 (Africa/Mogadishu)",
  "+3 (Africa/Nairobi)",
  "+3 (Antarctica/Syowa)",
  "+3 (Asia/Aden)",
  "+3 (Asia/Amman)",
  "+3 (Asia/Baghdad)",
  "+3 (Asia/Bahrain)",
  "+3 (Asia/Beirut)",
  "+3 (Asia/Damascus)",
  "+3 (Asia/Famagusta)",
  "+3 (Asia/Gaza)",
  "+3 (Asia/Hebron)",
  "+3 (Asia/Jerusalem)",
  "+3 (Asia/Kuwait)",
  "+3 (Asia/Nicosia)",
  "+3 (Asia/Qatar)",
  "+3 (Asia/Riyadh)",
  "+3 (Europe/Athens)",
  "+3 (Europe/Bucharest)",
  "+3 (Europe/Chisinau)",
  "+3 (Europe/Helsinki)",
  "+3 (Europe/Istanbul)",
  "+3 (Europe/Kiev)",
  "+3 (Europe/Kirov)",
  "+3 (Europe/Mariehamn)",
  "+3 (Europe/Minsk)",
  "+3 (Europe/Moscow)",
  "+3 (Europe/Riga)",
  "+3 (Europe/Simferopol)",
  "+3 (Europe/Sofia)",
  "+3 (Europe/Tallinn)",
  "+3 (Europe/Vilnius)",
  "+3 (Europe/Volgograd)",
  "+3 (Indian/Antananarivo)",
  "+3 (Indian/Comoro)",
  "+3 (Indian/Mayotte)",
  "+3:30 (Asia/Tehran)",
  "+4 (Asia/Baku)",
  "+4 (Asia/Dubai)",
  "+4 (Asia/Muscat)",
  "+4 (Asia/Tbilisi)",
  "+4 (Asia/Yerevan)",
  "+4 (Europe/Astrakhan)",
  "+4 (Europe/Samara)",
  "+4 (Europe/Saratov)",
  "+4 (Europe/Ulyanovsk)",
  "+4 (Indian/Mahe)",
  "+4 (Indian/Mauritius)",
  "+4 (Indian/Reunion)",
  "+4:30 (Asia/Kabul)",
  "+5 (Antarctica/Mawson)",
  "+5 (Antarctica/Vostok)",
  "+5 (Asia/Almaty)",
  "+5 (Asia/Aqtau)",
  "+5 (Asia/Aqtobe)",
  "+5 (Asia/Ashgabat)",
  "+5 (Asia/Atyrau)",
  "+5 (Asia/Dushanbe)",
  "+5 (Asia/Karachi)",
  "+5 (Asia/Oral)",
  "+5 (Asia/Qostanay)",
  "+5 (Asia/Qyzylorda)",
  "+5 (Asia/Samarkand)",
  "+5 (Asia/Tashkent)",
  "+5 (Asia/Yekaterinburg)",
  "+5 (Indian/Kerguelen)",
  "+5 (Indian/Maldives)",
  "+5:30 (Asia/Calcutta)",
  "+5:30 (Asia/Colombo)",
  "+5:45 (Asia/Katmandu)",
  "+6 (Asia/Bishkek)",
  "+6 (Asia/Dhaka)",
  "+6 (Asia/Omsk)",
  "+6 (Asia/Thimphu)",
  "+6 (Asia/Urumqi)",
  "+6 (Indian/Chagos)",
  "+6:30 (Asia/Rangoon)",
  "+6:30 (Indian/Cocos)",
  "+7 (Antarctica/Davis)",
  "+7 (Asia/Bangkok)",
  "+7 (Asia/Barnaul)",
  "+7 (Asia/Hovd)",
  "+7 (Asia/Jakarta)",
  "+7 (Asia/Krasnoyarsk)",
  "+7 (Asia/Novokuznetsk)",
  "+7 (Asia/Novosibirsk)",
  "+7 (Asia/Phnom_Penh)",
  "+7 (Asia/Pontianak)",
  "+7 (Asia/Ho_Chi_Minh)",
  "+7 (Asia/Tomsk)",
  "+7 (Asia/Vientiane)",
  "+7 (Indian/Christmas)",
  "+8 (Antarctica/Casey)",
  "+8 (Asia/Brunei)",
  "+8 (Asia/Hong_Kong)",
  "+8 (Asia/Irkutsk)",
  "+8 (Asia/Kuala_Lumpur)",
  "+8 (Asia/Kuching)",
  "+8 (Asia/Macau)",
  "+8 (Asia/Makassar)",
  "+8 (Asia/Manila)",
  "+8 (Asia/Shanghai)",
  "+8 (Asia/Singapore)",
  "+8 (Asia/Taipei)",
  "+8 (Asia/Ulaanbaatar)",
  "+8 (Australia/Perth)",
  "+8:45 (Australia/Eucla)",
  "+9 (Asia/Chita)",
  "+9 (Asia/Dili)",
  "+9 (Asia/Jayapura)",
  "+9 (Asia/Khandyga)",
  "+9 (Asia/Pyongyang)",
  "+9 (Asia/Seoul)",
  "+9 (Asia/Tokyo)",
  "+9 (Asia/Yakutsk)",
  "+9 (Pacific/Palau)",
  "+9:30 (Australia/Adelaide)",
  "+9:30 (Australia/Broken_Hill)",
  "+9:30 (Australia/Darwin)"
];

      timeZones.forEach(zone => {
        const option = document.createElement('option');
        option.value = zone;
        option.textContent = zone;
        timeZoneSelect.appendChild(option);
      });

      // Load tiền tệ từ API JSON mở
      try {
        const res = await fetch('https://open.er-api.com/v6/latest/USD');
        if (!res.ok) throw new Error('API không phản hồi');
        const data = await res.json();
        const currencies = data.rates;

        Object.keys(currencies).forEach(code => {
          const option = document.createElement('option');
          option.value = code;
          option.textContent = `${code}`;
          currencySelect.appendChild(option);
        });
      } catch (err) {
        console.error('Không thể tải danh sách tiền tệ, sử dụng danh sách mặc định:', err);
        const defaultCurrencies = ['USD', 'VND', 'EUR', 'GBP', 'JPY'];
        defaultCurrencies.forEach(code => {
          const option = document.createElement('option');
          option.value = code;
          option.textContent = code;
          currencySelect.appendChild(option);
        });
      }

      $('#currencyCode').select2({ placeholder: 'Chọn tiền tệ', allowClear: true });
      $('#timeZone').select2({ placeholder: 'Chọn múi giờ', allowClear: true });
    };

    // Xử lý form chạy
    document.getElementById('mccForm').addEventListener('submit', function(event) {
      event.preventDefault();

      const managerAccountId = document.getElementById('managerAccountId').value.trim();
      const accountName = document.getElementById('accountName').value.trim();
      const currencyCode = document.getElementById('currencyCode').value;
      const timeZone = document.getElementById('timeZone').value;
      const numberOfAccount = parseInt(document.getElementById('numberOfAccount').value);

      if (!managerAccountId || !accountName || !currencyCode || !timeZone || !numberOfAccount) {
        document.getElementById('result').className = 'message failure';
        document.getElementById('result').innerText = "Vui lòng điền đầy đủ thông tin trước khi chạy.";
        return;
      }

      document.getElementById('result').className = 'message success';
      document.getElementById('result').innerText = "Đang xử lý...";

      setTimeout(() => {
        document.getElementById('result').innerText = "";
        document.getElementById('successModal').style.display = 'flex';
      }, 500);
    });

    // Đóng modal khi bấm Xác nhận
    document.getElementById('confirmBtn').addEventListener('click', function() {
      document.getElementById('successModal').style.display = 'none';
    });

    // Xử lý lưu
    document.getElementById('saveButton').addEventListener('click', function() {
      const managerAccountId = document.getElementById('managerAccountId').value.trim();
      const accountName = document.getElementById('accountName').value.trim();
      const currencyCode = document.getElementById('currencyCode').value;
      const timeZone = document.getElementById('timeZone').value;
      const numberOfAccount = document.getElementById('numberOfAccount').value;

      let missing = [];
      if (!managerAccountId) missing.push("Mã MCC");
      if (!accountName) missing.push("Tên tài khoản");
      if (!currencyCode) missing.push("Tiền tệ");
      if (!timeZone) missing.push("Múi giờ");
      if (!numberOfAccount) missing.push("Số lượng tài khoản");

      if (missing.length > 0) {
        document.getElementById('result').className = 'message failure';
        document.getElementById('result').innerText = "Thiếu: " + missing.join(", ");
      } else {
        document.getElementById('result').className = 'message success';
        document.getElementById('result').innerText = "Lưu thành công!";
      }
    });
  </script>
</body>
</html>
